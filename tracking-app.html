<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏û‡∏±‡∏™‡∏î‡∏∏ | Order Tracking</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
</head>
<body class="bg-slate-50 text-slate-800 font-sans min-h-screen flex flex-col">
    <header class="bg-white shadow-sm p-4 relative flex items-center justify-center">
        <h1 class="text-xl font-bold text-indigo-700" data-i18n="title_main">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h1>
        
        <!-- ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏†‡∏≤‡∏©‡∏≤ -->
        <select id="langSelect" class="absolute right-4 top-4 bg-slate-100 border-none text-sm font-medium text-slate-600 rounded-lg px-2 py-1 cursor-pointer outline-none focus:ring-2 focus:ring-indigo-500">
            <option value="th">üáπüá≠ ‡πÑ‡∏ó‡∏¢</option>
            <option value="en">üá¨üáß English</option>
            <option value="zh">üá®üá≥ ‰∏≠Êñá</option>
            <option value="ja">üáØüáµ Êó•Êú¨Ë™û</option>
        </select>
    </header>

    <main class="max-w-md mx-auto p-4 mt-4 relative flex-1 w-full">
        <!-- ‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
        <form id="searchForm" class="bg-white p-4 rounded-xl shadow-sm mb-6 flex gap-2 border border-slate-100">
            <input type="text" id="searchId" required data-i18n-placeholder="placeholder_search" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏û‡∏±‡∏™‡∏î‡∏∏ WAN-..." class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 uppercase font-bold text-slate-700">
            <button type="submit" class="bg-indigo-600 text-white px-4 rounded-lg hover:bg-indigo-700 transition-colors"><i class="ph ph-magnifying-glass text-lg"></i></button>
        </form>

        <!-- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î -->
        <div id="loading" class="hidden text-center py-12">
            <i class="ph ph-spinner animate-spin text-5xl text-indigo-500 mb-3 inline-block"></i>
            <p class="text-slate-500 font-medium" data-i18n="loading_text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö...</p>
        </div>

        <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå -->
        <div id="resultBox" class="hidden bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
            <div class="border-b border-slate-100 pb-4 mb-6">
                <p class="text-sm text-slate-500 mb-1" data-i18n="tracking_no_label">‡πÄ‡∏•‡∏Ç‡∏û‡∏±‡∏™‡∏î‡∏∏</p>
                <h2 id="showId" class="text-2xl font-bold tracking-wider text-indigo-700">WAN---</h2>
                <p class="text-sm text-slate-600 mt-1 flex items-center">
                    <i class="ph ph-user mr-1"></i> 
                    <span data-i18n="customer_name_label" class="mr-1">‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</span>
                    <span id="nameSpan" class="font-medium text-slate-800">‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</span>
                </p>
            </div>

            <!-- Stepper / Timeline -->
            <div class="relative pl-6 space-y-8 before:absolute before:inset-y-0 before:left-2 before:w-0.5 before:bg-slate-200">
                <!-- Step 1: Pending -->
                <div class="relative">
                    <div class="absolute -left-8 w-4 h-4 rounded-full bg-indigo-500 ring-4 ring-white"></div>
                    <h3 class="font-bold text-slate-800" data-i18n="step1_title">‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (‡∏£‡∏≠‡∏à‡∏±‡∏î‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°)</h3>
                    <p class="text-xs text-slate-500 mt-0.5" id="time1">-</p>
                </div>
                <!-- Step 2: Shipping -->
                <div class="relative">
                    <div class="absolute -left-8 w-4 h-4 rounded-full bg-slate-200 ring-4 ring-white transition-colors duration-500" id="dot2"></div>
                    <h3 class="font-bold text-slate-400 transition-colors duration-500" id="text2" data-i18n="step2_title">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô (‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏î‡∏™‡πà‡∏á)</h3>
                    <p class="text-xs text-slate-400 mt-0.5 transition-colors duration-500" id="time2" data-i18n="waiting_update">‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï</p>
                </div>
                <!-- Step 3: Completed -->
                <div class="relative">
                    <div class="absolute -left-8 w-4 h-4 rounded-full bg-slate-200 ring-4 ring-white transition-colors duration-500" id="dot3"></div>
                    <h3 class="font-bold text-slate-400 transition-colors duration-500" id="text3" data-i18n="step3_title">‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</h3>
                    <p class="text-xs text-slate-400 mt-0.5 transition-colors duration-500" id="time3" data-i18n="waiting_update">‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï</p>
                    
                    <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ -->
                    <div id="proofBox" class="hidden mt-3 bg-slate-50 p-3 rounded-lg border border-slate-100">
                        <p class="text-xs font-bold text-slate-700 mb-1">
                            <span data-i18n="note_label">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</span> <span id="showNote" class="font-normal"></span>
                        </p>
                        <a id="proofImageLink" href="#" target="_blank" class="inline-flex items-center text-sm text-indigo-600 hover:text-indigo-800 font-medium mt-1">
                            <i class="ph ph-image mr-1 text-lg"></i> <span data-i18n="view_proof">‡∏î‡∏π‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</span>
                        </a>
                    </div>
                </div>
            </div>

            <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à -->
            <div id="surveyBox" class="hidden mt-8 p-5 bg-gradient-to-br from-indigo-50 to-blue-50 border border-indigo-100 rounded-xl text-center shadow-sm">
                <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center mx-auto mb-3 shadow-sm text-yellow-400 text-2xl">
                    <i class="ph-fill ph-star"></i>
                </div>
                <h4 class="font-bold text-indigo-800 mb-1" data-i18n="survey_title">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏≤</h4>
                <p id="surveyText" class="text-xs text-indigo-600 mb-4">‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà --/--/----</p>
                <a id="surveyBtn" href="https://forms.gle/iWpViNdXNXDsEwXq7" target="_blank" class="inline-flex items-center justify-center bg-indigo-600 text-white font-bold py-2.5 px-6 rounded-lg shadow-md hover:bg-indigo-700 hover:shadow-lg transition-all w-full sm:w-auto">
                    <i class="ph ph-clipboard-text mr-2 text-lg"></i> <span id="surveyBtnText" data-i18n="survey_btn_active">‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</span>
                </a>
            </div>
        </div>

        <!-- ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
        <div id="notFound" class="hidden text-center text-red-500 mt-10 bg-red-50 p-6 rounded-2xl border border-red-100">
            <i class="ph ph-warning-circle text-5xl mb-3 inline-block text-red-400"></i>
            <h3 class="font-bold text-lg mb-1" data-i18n="not_found_title">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
            <p id="errorMsg" class="text-slate-600 text-sm" data-i18n="not_found_desc">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏•‡∏Ç‡∏û‡∏±‡∏™‡∏î‡∏∏‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</p>
        </div>

        <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô -->
        <div class="text-center mt-8 mb-2">
            <a href="https://ponrakitt.site/report.html" target="_blank" class="inline-flex items-center text-sm text-slate-500 hover:text-indigo-600 transition-colors bg-white px-5 py-2.5 rounded-full shadow-sm border border-slate-200 hover:shadow-md">
                <i class="ph ph-warning-circle mr-1.5 text-lg"></i> <span data-i18n="report_issue">‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô / ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</span>
            </a>
        </div>
    </main>

    <!-- ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏£‡πâ‡∏≤‡∏ô -->
    <footer class="text-center py-6 mt-auto">
        <p class="text-xs text-slate-400">
            <span data-i18n="footer_note">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô</span>
            <a href="https://www.wanflorist.net/" target="_blank" class="text-indigo-500 hover:text-indigo-700 hover:underline transition-colors font-medium mx-1">
                www.wanflorist.net
            </a> 
            <span data-i18n="footer_only">‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</span>
        </p>
    </footer>

    <script>
        const GAS_URL = "https://script.google.com/macros/s/AKfycbzkluk985oNTIFFPJ5tyNNWy3yMrWj7K-JKg27mdAGfxdYEfzKdcb0uSwiidu_iWrzE/exec";
        
        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏õ‡∏•‡∏†‡∏≤‡∏©‡∏≤ (i18n) ---
        const translations = {
            th: {
                title_main: "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤",
                placeholder_search: "‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏û‡∏±‡∏™‡∏î‡∏∏ WAN-...",
                loading_text: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö...",
                tracking_no_label: "‡πÄ‡∏•‡∏Ç‡∏û‡∏±‡∏™‡∏î‡∏∏",
                customer_name_label: "‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:",
                step1_title: "‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (‡∏£‡∏≠‡∏à‡∏±‡∏î‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°)",
                step2_title: "‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô (‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏î‡∏™‡πà‡∏á)",
                step3_title: "‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
                waiting_update: "‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï",
                note_label: "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:",
                no_note: "-‡πÑ‡∏°‡πà‡∏°‡∏µ-",
                view_proof: "‡∏î‡∏π‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á",
                survey_title: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏≤",
                survey_btn_active: "‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á",
                survey_btn_expired: "‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô",
                survey_expired_text: "‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢ ‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß",
                survey_open_until: "‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà",
                not_found_title: "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
                not_found_desc: "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏•‡∏Ç‡∏û‡∏±‡∏™‡∏î‡∏∏‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô",
                report_issue: "‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô / ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô",
                footer_note: "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô",
                footer_only: "‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô",
                status_processing: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£",
                status_delivered: "‡∏û‡∏±‡∏™‡∏î‡∏∏‡∏ñ‡∏∂‡∏á‡∏°‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß",
                error_network: "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢",
                locale_date: "th-TH"
            },
            en: {
                title_main: "Track Your Order",
                placeholder_search: "Enter tracking no. WAN-...",
                loading_text: "Searching system data...",
                tracking_no_label: "Tracking No.",
                customer_name_label: "Customer Name:",
                step1_title: "Order Received (Preparing)",
                step2_title: "Dispatched (Out for delivery)",
                step3_title: "Delivered Successfully",
                waiting_update: "Waiting for update",
                note_label: "Note:",
                no_note: "-None-",
                view_proof: "View delivery proof",
                survey_title: "Your satisfaction is important to us",
                survey_btn_active: "Rate Delivery",
                survey_btn_expired: "Evaluation Expired",
                survey_expired_text: "Sorry, the feedback period for this order has expired.",
                survey_open_until: "Feedback open until",
                not_found_title: "Not Found",
                not_found_desc: "Please check the tracking number or contact admin.",
                report_issue: "Report Issue / Contact Admin",
                footer_note: "Note: This system is exclusively for",
                footer_only: "only.",
                status_processing: "Processing",
                status_delivered: "Package delivered to recipient",
                error_network: "Network connection error",
                locale_date: "en-GB"
            },
            zh: {
                title_main: "ËÆ¢ÂçïÁä∂ÊÄÅÊü•ËØ¢",
                placeholder_search: "ËæìÂÖ•Âø´ÈÄíÂçïÂè∑ WAN-...",
                loading_text: "Ê≠£Âú®Êü•ËØ¢Á≥ªÁªüÊï∞ÊçÆ...",
                tracking_no_label: "Âø´ÈÄíÂçïÂè∑",
                customer_name_label: "ÂÆ¢Êà∑ÂßìÂêç:",
                step1_title: "Êî∂Âà∞ËÆ¢Âçï (ÂáÜÂ§á‰∏≠)",
                step2_title: "Â∑≤ÂèëË¥ß (Ê¥æÈÄÅ‰∏≠)",
                step3_title: "Â∑≤Á≠æÊî∂",
                waiting_update: "Á≠âÂæÖÊõ¥Êñ∞",
                note_label: "Â§áÊ≥®:",
                no_note: "-Êó†-",
                view_proof: "Êü•ÁúãÈÄÅËææËØÅÊòé",
                survey_title: "ÊÇ®ÁöÑÊª°ÊÑèÂØπÊàë‰ª¨ÂæàÈáçË¶Å",
                survey_btn_active: "ËØÑ‰ª∑ÈÖçÈÄÅ",
                survey_btn_expired: "ËØÑ‰ª∑Â∑≤ËøáÊúü",
                survey_expired_text: "Êä±Ê≠âÔºåËØ•ËÆ¢ÂçïÁöÑËØÑ‰ª∑Êó∂Èó¥Â∑≤ËøáÊúü„ÄÇ",
                survey_open_until: "ËØÑ‰ª∑ÂºÄÊîæËá≥",
                not_found_title: "Êú™ÊâæÂà∞Êï∞ÊçÆ",
                not_found_desc: "ËØ∑ÂÜçÊ¨°Ê£ÄÊü•Âø´ÈÄíÂçïÂè∑ÊàñËÅîÁ≥ªÁÆ°ÁêÜÂëò„ÄÇ",
                report_issue: "Êä•ÂëäÈóÆÈ¢ò / ËÅîÁ≥ªÁÆ°ÁêÜÂëò",
                footer_note: "Ê≥®ÊÑè: Êú¨Á≥ªÁªü‰ªÖ‰æõ",
                footer_only: "‰ΩøÁî®",
                status_processing: "Â§ÑÁêÜ‰∏≠",
                status_delivered: "ÂåÖË£πÂ∑≤ÈÄÅËææÊî∂‰ª∂‰∫∫",
                error_network: "ÁΩëÁªúËøûÊé•ÈîôËØØ",
                locale_date: "zh-CN"
            },
            ja: {
                title_main: "ÈÖçÈÄÅÁä∂Ê≥Å„ÅÆÁ¢∫Ë™ç",
                placeholder_search: "ËøΩË∑°Áï™Âè∑„ÇíÂÖ•Âäõ WAN-...",
                loading_text: "„Ç∑„Çπ„ÉÜ„É†„Éá„Éº„Çø„ÇíÊ§úÁ¥¢‰∏≠...",
                tracking_no_label: "ËøΩË∑°Áï™Âè∑",
                customer_name_label: "„ÅäÂÆ¢ÊßòÂêç:",
                step1_title: "Ê≥®ÊñáÂèó‰ªò (Ê∫ñÂÇô‰∏≠)",
                step2_title: "Áô∫ÈÄÅÊ∏à„Åø (ÈÖçÈÅî‰∏≠)",
                step3_title: "ÈÖçÈÅîÂÆå‰∫Ü",
                waiting_update: "Êõ¥Êñ∞ÂæÖ„Å°",
                note_label: "ÂÇôËÄÉ:",
                no_note: "-„Å™„Åó-",
                view_proof: "ÈÖçÈÅîË®ºÊòéÂÜôÁúü„ÇíË¶ã„Çã",
                survey_title: "„ÅäÂÆ¢Êßò„ÅÆÊ∫ÄË∂≥„ÅØÁßÅ„Åü„Å°„Å´„Å®„Å£„Å¶ÈáçË¶Å„Åß„Åô",
                survey_btn_active: "ÈÖçÈÅî„ÇíË©ï‰æ°„Åô„Çã",
                survey_btn_expired: "Ë©ï‰æ°„ÅÆÊúüÈôêÂàá„Çå",
                survey_expired_text: "Áî≥„ÅóË®≥„ÅÇ„Çä„Åæ„Åõ„Çì„Åå„ÄÅ„Åì„ÅÆÊ≥®Êñá„ÅÆË©ï‰æ°ÊúüÈñì„ÅØÁµÇ‰∫Ü„Åó„Åæ„Åó„Åü„ÄÇ",
                survey_open_until: "Ë©ï‰æ°Âèó‰ªòÊúüÈôê:",
                not_found_title: "„Éá„Éº„Çø„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì",
                not_found_desc: "ËøΩË∑°Áï™Âè∑„Çí„ÇÇ„ÅÜ‰∏ÄÂ∫¶Á¢∫Ë™ç„Åô„Çã„Åã„ÄÅÁÆ°ÁêÜËÄÖ„Å´„ÅäÂïè„ÅÑÂêà„Çè„Åõ„Åè„Å†„Åï„ÅÑ„ÄÇ",
                report_issue: "ÂïèÈ°å„ÅÆÂ†±Âëä / ÁÆ°ÁêÜËÄÖ„Å´ÈÄ£Áµ°",
                footer_note: "Ê≥®ÊÑè: „Åì„ÅÆ„Ç∑„Çπ„ÉÜ„É†„ÅØ",
                footer_only: "Â∞ÇÁî®„Åß„Åô",
                status_processing: "Âá¶ÁêÜ‰∏≠",
                status_delivered: "Ëç∑Áâ©„ÅØÂèóÂèñ‰∫∫„Å´ÈÖçÈÅî„Åï„Çå„Åæ„Åó„Åü",
                error_network: "„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØÊé•Á∂ö„Ç®„É©„Éº",
                locale_date: "ja-JP"
            }
        };

        let currentLang = localStorage.getItem('appLang') || 'th';
        let currentOrderData = null; // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ß‡πâ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏†‡∏≤‡∏©‡∏≤

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏†‡∏≤‡∏©‡∏≤‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
        function applyLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('appLang', lang);
            document.getElementById('langSelect').value = lang;
            document.documentElement.lang = lang; // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï HTML lang attribute

            const t = translations[lang];

            // 1. ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° Text ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (t[key]) el.textContent = t[key];
            });

            // 2. ‡πÅ‡∏õ‡∏•‡∏á Placeholder
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (t[key]) el.placeholder = t[key];
            });

            // 3. ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Dynamic (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠)
            if (currentOrderData) {
                renderOrderData(currentOrderData);
            }
        }

        // ‡∏à‡∏±‡∏ö Event ‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏≤‡∏Å Dropdown
        document.getElementById('langSelect').addEventListener('change', (e) => {
            applyLanguage(e.target.value);
        });

        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏Å (‡∏î‡∏∂‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•) ---
        window.onload = () => {
            applyLanguage(currentLang); // ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏©‡∏≤‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö

            const urlOrderId = new URLSearchParams(window.location.search).get('orderId');
            if (urlOrderId) {
                document.getElementById('searchId').value = urlOrderId;
                fetchData(urlOrderId);
            }
        };

        document.getElementById('searchForm').onsubmit = (e) => {
            e.preventDefault();
            fetchData(document.getElementById('searchId').value.toUpperCase().trim());
        };

        function formatDate(dateString, lang) {
            if (!dateString) return '';
            const d = new Date(dateString);
            const localeStr = translations[lang].locale_date;
            return d.toLocaleString(localeStr, { dateStyle: 'medium', timeStyle: 'short' });
        }

        async function fetchData(id) {
            if (!id) return;
            
            const t = translations[currentLang];
            document.getElementById('resultBox').classList.add('hidden');
            document.getElementById('notFound').classList.add('hidden');
            document.getElementById('loading').classList.remove('hidden');

            try {
                const response = await fetch(`${GAS_URL}?orderId=${id}`);
                const result = await response.json();

                document.getElementById('loading').classList.add('hidden');

                if (result.status === 'success') {
                    currentOrderData = result.data; // ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏†‡∏≤‡∏©‡∏≤
                    renderOrderData(currentOrderData);
                } else {
                    currentOrderData = null;
                    document.getElementById('notFound').classList.remove('hidden');
                    document.getElementById('errorMsg').textContent = result.message || t.not_found_desc;
                }
            } catch (error) {
                console.error(error);
                currentOrderData = null;
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('notFound').classList.remove('hidden');
                document.getElementById('errorMsg').textContent = translations[currentLang].error_network;
            }
        }

        function renderOrderData(data) {
            const t = translations[currentLang];
            
            document.getElementById('resultBox').classList.remove('hidden');
            document.getElementById('showId').textContent = data.id;
            document.getElementById('nameSpan').textContent = data.name;

            // ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏•‡πâ‡∏≤‡∏á UI ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏ï‡πâ‡∏ô
            document.getElementById('time1').textContent = formatDate(data.created, currentLang);
            
            ['dot2', 'dot3'].forEach(id => document.getElementById(id).className = 'absolute -left-8 w-4 h-4 rounded-full bg-slate-200 ring-4 ring-white transition-colors duration-500');
            ['text2', 'text3'].forEach(id => document.getElementById(id).className = 'font-bold text-slate-400 transition-colors duration-500');
            
            document.getElementById('time2').textContent = t.waiting_update;
            document.getElementById('time3').textContent = t.waiting_update;
            document.getElementById('proofBox').classList.add('hidden');
            document.getElementById('surveyBox').classList.add('hidden');

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏î‡∏™‡πà‡∏á"
            if (data.status === 'shipping' || data.status === 'completed') {
                document.getElementById('dot2').classList.replace('bg-slate-200', 'bg-blue-500');
                document.getElementById('text2').classList.replace('text-slate-400', 'text-blue-600');
                document.getElementById('time2').textContent = formatDate(data.shippedDate, currentLang) || t.status_processing;
                document.getElementById('time2').classList.replace('text-slate-400', 'text-blue-500');
            }

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"
            if (data.status === 'completed') {
                document.getElementById('dot3').classList.replace('bg-slate-200', 'bg-green-500');
                document.getElementById('text3').classList.replace('text-slate-400', 'text-green-600');
                document.getElementById('time3').textContent = formatDate(data.completedDate, currentLang) || t.status_delivered; 
                document.getElementById('time3').classList.replace('text-slate-400', 'text-green-500');

                document.getElementById('proofBox').classList.remove('hidden');
                document.getElementById('showNote').textContent = data.note || t.no_note;
                document.getElementById('proofImageLink').href = data.imageUrl;

                setupSurveyBox(data.completedDate);
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°
        function setupSurveyBox(completedDateString) {
            if (!completedDateString) return;

            const t = translations[currentLang];
            const completedDate = new Date(completedDateString);
            const expireDate = new Date(completedDate);
            expireDate.setDate(expireDate.getDate() + 15);
            const now = new Date();

            const surveyBox = document.getElementById('surveyBox');
            const surveyBtn = document.getElementById('surveyBtn');
            const surveyBtnText = document.getElementById('surveyBtnText');
            const surveyText = document.getElementById('surveyText');

            surveyBox.classList.remove('hidden');

            if (now <= expireDate) {
                // ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏
                surveyBtn.href = "https://forms.gle/iWpViNdXNXDsEwXq7";
                surveyBtn.className = "inline-flex items-center justify-center bg-indigo-600 text-white font-bold py-2.5 px-6 rounded-lg shadow-md hover:bg-indigo-700 hover:shadow-lg transition-all w-full sm:w-auto";
                surveyBtn.innerHTML = `<i class="ph ph-clipboard-text mr-2 text-lg"></i> <span id="surveyBtnText" data-i18n="survey_btn_active">${t.survey_btn_active}</span>`;
                
                const expireStr = expireDate.toLocaleDateString(t.locale_date, { day: 'numeric', month: 'short', year: 'numeric' });
                surveyText.textContent = `${t.survey_open_until} ${expireStr}`;
                surveyText.className = "text-xs text-indigo-600 mb-4";
            } else {
                // ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß
                surveyBtn.removeAttribute('href');
                surveyBtn.className = "inline-flex items-center justify-center bg-slate-300 text-slate-500 font-bold py-2.5 px-6 rounded-lg cursor-not-allowed w-full sm:w-auto";
                surveyBtn.innerHTML = `<i class="ph ph-lock-key mr-2 text-lg"></i> <span id="surveyBtnText" data-i18n="survey_btn_expired">${t.survey_btn_expired}</span>`;
                
                surveyText.textContent = t.survey_expired_text;
                surveyText.className = "text-xs text-red-500 mb-4 font-medium";
            }
        }
    </script>
</body>
</html>
